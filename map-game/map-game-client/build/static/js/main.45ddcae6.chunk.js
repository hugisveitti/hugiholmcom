(this["webpackJsonpmap-game-client"]=this["webpackJsonpmap-game-client"]||[]).push([[0],{144:function(e,t,n){},177:function(e,t){},199:function(e,t,n){},202:function(e,t,n){},203:function(e,t,n){"use strict";n.r(t);var a=n(3),c=n(0),r=n.n(c),o=n(15),i=n.n(o),s=(n(144),n(127)),j=n(22),l=n(12),b=n(16),d=n(27),u=n(237),O=n(238),h=n(252),m=n(240),x=n(231),g=n(254),f=n(234),p=n(236),v=["#52BE80","#DAF7A6","#FFC300","#FF5733","#2C3E50","#5D6D7E"],y=Object(x.a)((function(){return Object(g.a)({root:{flexGrow:1,minHeight:"100vh",position:"relative",backgroundColor:"#D1F2EB"},menuButton:{marginRight:20},title:{flexGrow:1},header:{backgroundColor:v[0]},footer:{backgroundColor:v[0],fontSize:10,margin:"auto",color:"white",position:"absolute",bottom:0,width:"100%",height:"2.5rem",padding:0,marginTop:20},footerContent:{margin:"auto"},container:{paddingTop:20,paddingBottom:100},buttonGreen:{background:v[0],color:"white"},cardContainer:{margin:"auto",width:400,backgroundColor:"#F9EBEA",textAlign:"center",padding:20,marginBottom:20,marginTop:20},icon:{width:"auto",height:60}})})),S=function(e){var t=e.children,n=y();return Object(a.jsxs)("div",{className:n.root,children:[Object(a.jsx)(f.a,{position:"static",children:Object(a.jsx)(p.a,{className:n.header,children:Object(a.jsx)("h3",{children:"JeoJuessr"})})}),Object(a.jsx)("div",{className:n.container,children:t}),Object(a.jsx)(p.a,{className:n.footer,children:Object(a.jsx)("div",{className:n.footerContent,children:"footer stuff"})})]})},N=n.p+"static/media/icon.f293e650.png",k=function(e){var t=e.socket,n=Object(d.a)(e,["socket"]),r=y(),o=Object(c.useState)(""),i=Object(l.a)(o,2),s=i[0],j=i[1],b=Object(c.useState)(""),x=Object(l.a)(b,2),g=x[0],f=x[1];return Object(a.jsx)(S,{children:Object(a.jsxs)("div",{style:{textAlign:"center"},children:[Object(a.jsx)("img",{className:r.icon,src:N,alt:"joejuessrlogo"}),Object(a.jsx)(u.a,{className:r.cardContainer,children:Object(a.jsxs)(O.a,{children:[Object(a.jsx)("p",{children:"Still in development"}),Object(a.jsx)("p",{children:"Please write in 'Room Name' anything, then tell your friends to write the same thing to play together. Or you can play by yourself."}),Object(a.jsx)("p",{children:"This is in development so there are probably hella bugs. ToDo: add leaderboard. Make finding new positions better. Using open street maps and Mapillary."}),Object(a.jsx)(h.a,{id:"player-text-field",placeholder:"Name",value:g,onChange:function(e){return f(e.target.value)}}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(h.a,{id:"room-text-field",placeholder:"Room Name",value:s,onChange:function(e){return j(e.target.value)}}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(m.a,{className:r.buttonGreen,variant:"contained",onClick:function(){""!==s&&""!==g&&(t.emit("roomConnection",{roomName:s,playerName:g}),n.history.push(ne))},children:"Connect"})]})})]})})},C=n(116),w=n.n(C),A=n(128),R=n(123),P=n(246),T=n(62),F=n(130),B=n(239),L=n(247),G=n(248),E=n(249),D=n(250),U=(n(199),n(21)),W=n.n(U),I=n(124),z=(n(200),n(125)),M=n(241),J=n(242),Y=n(243),_=n(244),H=n(245),K=n(255),q=function(e){var t=e.socket,n=e.setImageUrls,o=e.imageLoaded,i=e.guessSentCallback,s=e.isLeader,j=e.distance,b=e.roundPosition,d=e.setGuessSent,u=e.guessSent,O=e.players,h=e.playerName,x=e.roundOver,g=e.setRoundOver,f=Object(c.useState)({lat:51.505,lng:-.09}),p=Object(l.a)(f,2),v=p[0],S=p[1],N=y(),k=function(e){return W.a.icon({iconUrl:e?I.a:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-yellow.png",shadowUrl:z.a,iconSize:[25,41],iconAnchor:[10,41]})},C=function(){return b?Object(a.jsx)(M.a,{icon:k(!0),position:b}):null},w=function(){return b?Object(a.jsx)(J.a,{positions:[[b.lat,b.lng],[v.lat,v.lng]]}):null},A=function(){return Object(Y.a)({click:function(e){console.log("map clicked",e.latlng),x||S({lat:e.latlng.lat,lng:e.latlng.lng})}}),Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(M.a,{icon:k(!1),position:v}),x&&Object(a.jsx)(C,{}),x&&Object(a.jsx)(w,{}),O.map((function(e){return e.markerPosition&&e.name!==h?Object(a.jsx)(M.a,{icon:W.a.icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-grey.png",iconSize:[25,41],iconAnchor:[10,41]}),position:e.markerPosition,children:Object(a.jsx)(_.a,{children:e.name})},e.name):null}))]})},R=function(){t.emit("handleStartNextRound",{}),n([]),d(!1),g(!1)},P=function(){return u&&b||x?s?Object(a.jsx)("div",{style:{textAlign:"center"},children:Object(a.jsx)(m.a,{onClick:R,variant:"contained",className:N.buttonGreen,children:"Start next round"})}):Object(a.jsx)("div",{style:{textAlign:"center"},children:Object(a.jsx)(T.a,{children:"Waiting for leader to start next round"})}):null};return Object(a.jsxs)("div",{style:{padding:20},children:[Object(a.jsxs)(H.a,{center:[51.505,-.09],zoom:2,style:{height:400,width:"70%",margin:"auto",marginBottom:15},bounds:W.a.latLngBounds(W.a.latLng(90,180),W.a.latLng(-90,-180)),children:[Object(a.jsx)(A,{}),Object(a.jsx)(K.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager_labels_under/{z}/{x}/{y}.png"})]}),b&&Object(a.jsx)(r.a.Fragment,{children:-1!==j?Object(a.jsxs)(T.a,{style:{textAlign:"center",paddingBottom:20},children:["You were ",j.toLocaleString()," KM from the correct position."]}):Object(a.jsx)(T.a,{style:{textAlign:"center",paddingBottom:20},children:"You did not guess this round."})}),o&&!b&&Object(a.jsx)("div",{style:{textAlign:"center"},children:Object(a.jsx)(m.a,{onClick:function(){i(),d(!0);var e=function(e){var t=0;for(e<180?t=360:e>180&&(t=-360);Math.abs(e)>180;)e+=t;return e}(+v.lng);t.emit("handleSendGuess",{position:{lat:v.lat,lng:e}})},variant:"contained",className:N.greenButton,children:"Send"})}),u&&!b&&Object(a.jsx)("div",{style:{textAlign:"center",paddingBottom:20},children:Object(a.jsx)(T.a,{children:"Waiting for other players to finish."})}),Object(a.jsx)(P,{})]})},Q=function(e){return e.sort((function(e,t){return e.score<t.score?1:e.score>t.score?-1:0}))},V=function(e){var t=e.socket,n=Object(c.useState)(0),o=Object(l.a)(n,2),i=o[0],s=o[1],j=Object(c.useState)(""),b=Object(l.a)(j,2),d=b[0],u=b[1],O=Object(c.useState)([]),h=Object(l.a)(O,2),x=h[0],g=h[1],f=Object(c.useState)(!1),p=Object(l.a)(f,2),v=p[0],k=p[1],C=Object(c.useState)(!1),w=Object(l.a)(C,2),U=w[0],W=w[1],I=Object(c.useState)([]),z=Object(l.a)(I,2),M=z[0],J=z[1],Y=Object(c.useState)(!1),_=Object(l.a)(Y,2),H=_[0],K=_[1],V=Object(c.useState)(-1),X=Object(l.a)(V,2),Z=X[0],$=X[1],ee=Object(c.useState)(void 0),te=Object(l.a)(ee,2),ne=te[0],ae=te[1],ce=Object(c.useState)(60),re=Object(l.a)(ce,2),oe=re[0],ie=re[1],se=Object(c.useState)("countDownTimer"),je=Object(l.a)(se,2),le=je[0],be=je[1],de=Object(c.useState)(60),ue=Object(l.a)(de,2),Oe=ue[0],he=ue[1],me=Object(c.useState)(0),xe=Object(l.a)(me,2),ge=xe[0],fe=xe[1],pe=Object(c.useState)(0),ve=Object(l.a)(pe,2),ye=ve[0],Se=ve[1],Ne=Object(c.useState)(!1),ke=Object(l.a)(Ne,2),Ce=ke[0],we=ke[1],Ae=Object(c.useState)(!1),Re=Object(l.a)(Ae,2),Pe=Re[0],Te=Re[1],Fe=Object(c.useState)(""),Be=Object(l.a)(Fe,2),Le=Be[0],Ge=Be[1],Ee=Object(c.useState)(""),De=Object(l.a)(Ee,2),Ue=De[0],We=De[1],Ie=Object(c.useState)(!1),ze=Object(l.a)(Ie,2),Me=ze[0],Je=ze[1],Ye=Object(c.useState)(!1),_e=Object(l.a)(Ye,2),He=_e[0],Ke=_e[1],qe=y(),Qe=Object(c.useCallback)((function(){be("countDownTimer"===le?"countDownTimer2":"countDownTimer"),ie(Oe),W(!0)}),[le,Oe]);Object(c.useEffect)((function(){t&&(t.on("handleSendImages",(function(e){we(!1);var t=e.gameData,n=e.players;n=Q(n);var a=e.timePerRound,c=e.currentRound,r=e.numberOfRounds,o=e.roomName;Ge(o),fe(c),Se(r),he(a),ie(a),J(n);var i=[];if(t.features.length>0){for(var j=0;j<t.features.length;j++){var l=t.features[j].properties.key,b="https://images.mapillary.com/".concat(l,"/thumb-2048.jpg");i.push(b)}s(0),g(i),u(i[0]),k(!0),ae(void 0),$(-1),Te(!1),Qe(),Je(!1)}})),t.on("handleRoundOver",(function(e){var t=e.isGameLeader,n=e.correctPosition,a=e.distance,c=e.players,r=e.playerName;We(r),J(c),ae(n),$(a),K(t),W(!1),Je(!0)})),t.on("handleGameOver",(function(e){var t=e.players;t=Q(t),J(t),we(!0)})),t.on("gameStarted",(function(){we(!1),$(-1),Ke(!1),Je(!1),ae(void 0)})))}),[t,Qe]);var Ve=function(e){for(var t=document.getElementsByClassName("pnlm-render-container")[0];t.childNodes.length>0;)t.removeChild(t.childNodes[0]);u(x[e])},Xe=function(){Ke(!0),t.emit("handleStartGame",{timePerRound:Oe,numberOfRounds:ye})},Ze=function(){return Object(a.jsx)(A.a,{width:"100%",height:"500px",image:d,pitch:10,yaw:180,hfov:110,compass:!0,autoLoad:!0})},$e=function(){return He?Object(a.jsx)("div",{style:{textAlign:"center"},children:Object(a.jsx)(P.a,{})}):Object(a.jsx)(m.a,{variant:"contained",onClick:Xe,className:qe.buttonGreen,children:"Play again"})};return Object(a.jsxs)(S,{children:[Ce?Object(a.jsxs)("div",{style:{textAlign:"center"},children:[Object(a.jsx)("h3",{children:"Game Over"}),H?Object(a.jsx)($e,{}):Object(a.jsx)(T.a,{children:"Waiting for leader to start again"})]}):Object(a.jsxs)(r.a.Fragment,{children:[Object(a.jsxs)("div",{id:"info-container",style:{padding:15,textAlign:"center",position:"relevant"},children:[Object(a.jsx)("div",{id:"count-down-container",style:{margin:"auto",position:"absolute",top:90,left:10},children:Object(a.jsx)(R.CountdownCircleTimer,{isPlaying:U,size:70,duration:oe,colors:[["#004777",.33],["#F7B801",.33],["#A30000",.33]],children:function(e){return e.remainingTime}},le)}),Object(a.jsx)("img",{className:qe.icon,src:N,alt:"jjicon"}),Object(a.jsxs)(T.a,{children:["Round ",ge," of ",ye]})]}),x.length>0?Object(a.jsxs)("div",{className:"pano-container",children:[Object(a.jsxs)(T.a,{style:{textAlign:"center"},children:[i+1," / ",x.length," "]}),Object(a.jsx)("button",{className:"pano-btn",id:"pano-prev-btn",onClick:function(){var e=-1;0===i?(s(x.length-1),e=x.length-1):(s(i-1),e=i-1),Ve(e)},children:Object(a.jsx)("i",{className:"arrow arrow-left"})}),Object(a.jsx)("button",{className:"pano-btn arrow-right",id:"pano-next-btn",onClick:function(){var e=-1;i===x.length-1?(e=0,s(0)):(e=i+1,s(i+1)),Ve(e)},children:Object(a.jsx)("i",{className:"arrow"})}),Object(a.jsx)(Ze,{})]}):Pe?Object(a.jsx)(T.a,{style:{textAlign:"center"},children:"Waiting for leader to start round."}):Object(a.jsx)("div",{style:{textAlign:"center"},children:Object(a.jsx)(P.a,{})}),Object(a.jsx)(q,{socket:t,setImageUrls:g,imageLoaded:v,guessSentCallback:function(){k(!1)},isLeader:H,distance:Z,roundPosition:ne,setGuessSent:Te,guessSent:Pe,players:M,playerName:Ue,roundOver:Me,setRoundOver:Je})]}),M.length>0&&Object(a.jsxs)(F.a,{className:qe.cardContainer,children:[Object(a.jsxs)(T.a,{variant:"h6",children:["Players in room ",Le]}),Object(a.jsxs)(B.a,{dense:!1,style:{width:400,margin:"auto"},children:[Object(a.jsxs)(L.a,{children:[Object(a.jsx)(G.a,{inset:!0,children:"Name"}),Object(a.jsx)(G.a,{children:"Score"})]}),M.map((function(e,t){var n=t%2===0?"#ffeeee":"inherit";return Object(a.jsx)(r.a.Fragment,{children:Object(a.jsxs)(L.a,{style:{backgroundColor:n},children:[e.isLeader&&Object(a.jsx)(E.a,{children:Object(a.jsx)(D.a,{})}),Object(a.jsx)(G.a,{inset:!e.isLeader,primary:e.name}),Object(a.jsx)(G.a,{primary:(+e.score).toLocaleString()})]})},"".concat(e.name,"-").concat(t))}))]})]})]})},X=n(251),Z=n(253),$=function(e){var t=e.socket,n=Object(d.a)(e,["socket"]),o=Object(c.useState)(""),i=Object(l.a)(o,2),s=i[0],j=i[1],b=Object(c.useState)([]),u=Object(l.a)(b,2),O=u[0],x=u[1],g=Object(c.useState)(!1),f=Object(l.a)(g,2),p=f[0],v=f[1],N=Object(c.useState)(5),k=Object(l.a)(N,2),C=k[0],w=k[1],A=Object(c.useState)(60),R=Object(l.a)(A,2),P=R[0],U=R[1],W=Object(c.useState)(!0),I=Object(l.a)(W,2),z=I[0],M=I[1],J=Object(c.useState)(!1),Y=Object(l.a)(J,2),_=Y[0],H=Y[1],K=y();Object(c.useEffect)((function(){t&&(t.emit("connectedToWaitingRoom"),t.once("connectedToWaitingRoomCallback",(function(e){var t=e.roomName,n=e.players,a=e.isLeader;j(t),v(a),x(n)})),t.on("updatePlayers",(function(e){var t=e.players;t&&x(t)})),t.on("gameStarted",(function(){n.history.push(te)})))}),[t,n.history]);return Object(a.jsx)(S,{children:Object(a.jsxs)(F.a,{elevation:1,className:K.cardContainer,children:[Object(a.jsx)("h3",{children:"Waiting room"}),Object(a.jsxs)("h5",{children:["Room ",s]}),Object(a.jsxs)(T.a,{children:["To play with your friends, tell them to write '",s,"' in the room inputbox and press connect!"]}),Object(a.jsx)(T.a,{children:"Players in room"}),Object(a.jsx)(B.a,{style:{width:200,margin:"auto"},children:O.map((function(e,t){return Object(a.jsx)(r.a.Fragment,{children:Object(a.jsxs)(L.a,{children:[Object(a.jsx)(G.a,{children:e.name}),e.isLeader?Object(a.jsx)(E.a,{children:Object(a.jsx)(D.a,{})}):Object(a.jsx)(G.a,{})]})},"".concat(e.name,"-").concat(t))}))}),p?Object(a.jsxs)(r.a.Fragment,{children:[Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(T.a,{children:"Number of Rounds"}),Object(a.jsx)(h.a,{id:"numberofrounds-text-field",type:"number",placeholder:"Number of rounds",value:C,onChange:function(e){return w(e.target.value)}}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(T.a,{children:"Seconds per round"}),Object(a.jsx)(h.a,{id:"timeperround-text-field",type:"number",placeholder:"seconds per round",value:P,onChange:function(e){return U(e.target.value)}}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(X.a,{control:Object(a.jsx)(Z.a,{checked:z,onChange:function(){M(!z)}}),label:"Use only panoramas?"}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(X.a,{control:Object(a.jsx)(Z.a,{value:_,onChange:function(){return H(!_)}}),label:"Use only 40+ latitude?"}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(m.a,{onClick:function(){isNaN(+P)||isNaN(+C)||t.emit("handleStartGame",{timePerRound:P,numberOfRounds:C,onlyPano:z,onlyEuropeUsa:_})},variant:"contained",className:K.buttonGreen,children:"Start Game"})]}):Object(a.jsx)(T.a,{children:"Waiting for leader to start the game."})]})})},ee={ENDPOINT:window.location.hostname}.ENDPOINT,te="/game",ne="/waitingroom",ae=function(){var e=Object(c.useState)(void 0),t=Object(l.a)(e,2),n=t[0],r=t[1];return Object(c.useEffect)((function(){var e=w.a.connect(ee);r(e),e.on("connectedToRoomCallBack",(function(e){}))}),[]),Object(a.jsxs)(b.c,{children:[Object(a.jsx)(b.a,{exact:!0,path:"/",render:function(e){return Object(a.jsx)(k,Object(j.a)(Object(j.a)({},e),{},{socket:n}))}}),Object(a.jsx)(b.a,{path:te,render:function(e){return Object(a.jsx)(V,Object(j.a)(Object(j.a)({},e),{},{socket:n}))}}),Object(a.jsx)(b.a,{path:ne,render:function(e){return Object(a.jsx)($,Object(j.a)(Object(j.a)({},e),{},{socket:n}))}})]})};n(202);var ce=function(){return Object(a.jsx)(s.a,{basename:"/map-game",children:Object(a.jsx)(ae,{})})},re=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,257)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),a(e),c(e),r(e),o(e)}))};i.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(ce,{})}),document.getElementById("root")),re()}},[[203,1,2]]]);
//# sourceMappingURL=main.45ddcae6.chunk.js.map