(this["webpackJsonpmap-game-client"]=this["webpackJsonpmap-game-client"]||[]).push([[0],{103:function(e,t,n){},145:function(e,t,n){},179:function(e,t){},202:function(e,t,n){},203:function(e,t,n){"use strict";n.r(t);var a=n(3),r=n(0),c=n.n(r),o=n(15),s=n.n(o),i=(n(145),n(128)),l=n(22),j=n(12),d=n(16),u=n(27),b=n(237),O=n(238),m=n(252),h=n(240),g=n(231),x=n(254),f=n(234),p=n(236),v=["#52BE80","#DAF7A6","#FFC300","#FF5733","#2C3E50","#5D6D7E"],y=Object(g.a)((function(){return Object(x.a)({root:{flexGrow:1,minHeight:"100vh",position:"relative",backgroundColor:"#D1F2EB"},menuButton:{marginRight:20},title:{flexGrow:1},header:{backgroundColor:v[0]},footer:{backgroundColor:v[0],fontSize:10,margin:"auto",color:"white",position:"absolute",bottom:0,width:"100%",height:"2.5rem",padding:0,marginTop:20},footerContent:{margin:"auto"},container:{paddingTop:20,paddingBottom:100},buttonGreen:{background:v[0],color:"white"},cardContainer:{margin:"auto",width:400,backgroundColor:"#F9EBEA",textAlign:"center",padding:20,marginBottom:20,marginTop:20},icon:{width:"auto",height:60}})})),S=function(e){var t=e.children,n=y();return Object(a.jsxs)("div",{className:n.root,children:[Object(a.jsx)(f.a,{position:"static",children:Object(a.jsx)(p.a,{className:n.header,children:Object(a.jsx)("h3",{children:"JeoJuessr"})})}),Object(a.jsx)("div",{className:n.container,children:t}),Object(a.jsx)(p.a,{className:n.footer,children:Object(a.jsx)("div",{className:n.footerContent,children:"footer stuff"})})]})},N=n.p+"static/media/icon.f293e650.png",C=function(e){var t=e.socket,n=Object(u.a)(e,["socket"]),c=y(),o=Object(r.useState)(""),s=Object(j.a)(o,2),i=s[0],l=s[1],d=Object(r.useState)(""),g=Object(j.a)(d,2),x=g[0],f=g[1];return Object(a.jsx)(S,{children:Object(a.jsxs)("div",{style:{textAlign:"center"},children:[Object(a.jsx)("img",{className:c.icon,src:N,alt:"joejuessrlogo"}),Object(a.jsx)(b.a,{className:c.cardContainer,children:Object(a.jsxs)(O.a,{children:[Object(a.jsx)("p",{children:"Still in development"}),Object(a.jsx)("p",{children:"Please write in 'Room Name' anything, then tell your friends to write the same thing to play together. Or you can play by yourself."}),Object(a.jsx)("p",{children:"This is in development so there are probably hella bugs. ToDo: add leaderboard. Make finding new positions better. Using open street maps and Mapillary."}),Object(a.jsx)(m.a,{id:"player-text-field",placeholder:"Name",value:x,onChange:function(e){return f(e.target.value)}}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(m.a,{id:"room-text-field",placeholder:"Room Name",value:i,onChange:function(e){return l(e.target.value)}}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(h.a,{className:c.buttonGreen,variant:"contained",onClick:function(){""!==i&&""!==x&&(t.emit("roomConnection",{roomName:i,playerName:x}),n.history.push(re))},children:"Connect"})]})})]})})},k=n(117),w=n.n(k),R=n(118),P=n(246),T=n(63),I=function(e){return e.sort((function(e,t){return e.score<t.score?1:e.score>t.score?-1:0}))},L=(n(103),n(21)),A=n.n(L),G=n(119),D=(n(178),n(120)),F=n(241),U=n(242),B=n(243),E=n(244),W=n(245),z=n(255),M=function(e){var t=e.socket,n=e.setImageUrls,o=e.imageLoaded,s=e.guessSentCallback,i=e.isLeader,l=e.distance,d=e.roundPosition,u=e.setGuessSent,b=e.guessSent,O=e.players,m=e.playerName,g=e.roundOver,x=e.setRoundOver,f=Object(r.useState)({lat:51.505,lng:-.09}),p=Object(j.a)(f,2),v=p[0],S=p[1],N=y(),C=function(e){return A.a.icon({iconUrl:e?G.a:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-yellow.png",shadowUrl:D.a,iconSize:[25,41],iconAnchor:[10,41]})},k=function(){return d?Object(a.jsx)(F.a,{icon:C(!0),position:d}):null},w=function(){return d?Object(a.jsx)(U.a,{positions:[[d.lat,d.lng],[v.lat,v.lng]]}):null},R=function(){return Object(B.a)({click:function(e){console.log("map clicked",e.latlng),g||S({lat:e.latlng.lat,lng:e.latlng.lng})}}),Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(F.a,{icon:C(!1),position:v}),g&&Object(a.jsx)(k,{}),g&&Object(a.jsx)(w,{}),O.map((function(e){return e.markerPosition&&e.name!==m?Object(a.jsx)(F.a,{icon:A.a.icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-grey.png",iconSize:[25,41],iconAnchor:[10,41]}),position:e.markerPosition,children:Object(a.jsx)(E.a,{children:e.name})},e.name):null}))]})},P=function(){t.emit("handleStartNextRound",{}),n([]),u(!1),x(!1)},I=function(){return b&&d||g?i?Object(a.jsx)("div",{style:{textAlign:"center"},children:Object(a.jsx)(h.a,{onClick:P,variant:"contained",className:N.buttonGreen,children:"Start next round"})}):Object(a.jsx)("div",{style:{textAlign:"center"},children:Object(a.jsx)(T.a,{children:"Waiting for leader to start next round"})}):null};return Object(a.jsxs)("div",{style:{padding:20},children:[Object(a.jsxs)(W.a,{center:[51.505,-.09],zoom:2,style:{height:400,width:"70%",margin:"auto",marginBottom:15},bounds:A.a.latLngBounds(A.a.latLng(90,180),A.a.latLng(-90,-180)),children:[Object(a.jsx)(R,{}),Object(a.jsx)(z.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager_labels_under/{z}/{x}/{y}.png"})]}),d&&Object(a.jsx)(c.a.Fragment,{children:-1!==l?Object(a.jsxs)(T.a,{style:{textAlign:"center",paddingBottom:20},children:["You were ",l.toLocaleString()," KM from the correct position."]}):Object(a.jsx)(T.a,{style:{textAlign:"center",paddingBottom:20},children:"You did not guess this round."})}),o&&!d&&Object(a.jsx)("div",{style:{textAlign:"center"},children:Object(a.jsx)(h.a,{onClick:function(){s(),u(!0);var e=function(e){var t=0;for(e<180?t=360:e>180&&(t=-360);Math.abs(e)>180;)e+=t;return e}(+v.lng);t.emit("handleSendGuess",{position:{lat:v.lat,lng:e}})},variant:"contained",className:N.greenButton,children:"Send"})}),b&&!d&&Object(a.jsx)("div",{style:{textAlign:"center",paddingBottom:20},children:Object(a.jsx)(T.a,{children:"Waiting for other players to finish."})}),Object(a.jsx)(I,{})]})},J=n(129),Y=function(e){var t=e.imageUrls,n=e.imgUrl,c=e.currentIndex,o=e.setCurrentIndex,s=e.setImgUrl,i=e.guessSent,l=Object(r.useRef)(),j=function(){},d=function(e){for(var n=document.getElementsByClassName("pnlm-render-container")[0];n.childNodes.length>0;)n.removeChild(n.childNodes[0]);(null===l||void 0===l?void 0:l.current)&&l.current.panorama.destroy(),s(t[e])},u=function(){return Object(a.jsx)(J.a,{ref:l,width:"100%",height:"500px",image:n,pitch:10,yaw:180,hfov:110,compass:!0,autoLoad:!0,onLoad:j})};return t.length>0?Object(a.jsxs)("div",{className:"pano-container",children:[Object(a.jsxs)(T.a,{style:{textAlign:"center"},children:[c+1," / ",t.length," "]}),Object(a.jsx)("button",{className:"pano-btn",id:"pano-prev-btn",onClick:function(){var e=-1;0===c?(o(t.length-1),e=t.length-1):(o(c-1),e=c-1),d(e)},children:Object(a.jsx)("i",{className:"arrow arrow-left"})}),Object(a.jsx)("button",{className:"pano-btn arrow-right",id:"pano-next-btn",onClick:function(){var e=-1;c===t.length-1?(e=0,o(0)):(e=c+1,o(c+1)),d(e)},children:Object(a.jsx)("i",{className:"arrow"})}),Object(a.jsx)(u,{})]}):i?Object(a.jsx)(T.a,{style:{textAlign:"center"},children:"Waiting for leader to start round."}):Object(a.jsx)("div",{style:{textAlign:"center"},children:Object(a.jsx)(P.a,{})})},_=n(131),H=n(239),K=n(247),q=n(248),Q=n(249),V=n(250),X=function(e){var t=e.players,n=e.roomName,r=y();return Object(a.jsxs)(_.a,{className:r.cardContainer,children:[Object(a.jsxs)(T.a,{variant:"h6",children:["Players in room ",n]}),Object(a.jsxs)(H.a,{dense:!1,style:{width:400,margin:"auto"},children:[Object(a.jsxs)(K.a,{children:[Object(a.jsx)(q.a,{inset:!0,children:"Name"}),Object(a.jsx)(q.a,{children:"Score"})]}),t.map((function(e,t){var n=t%2===0?"#ffeeee":"inherit";return Object(a.jsx)(c.a.Fragment,{children:Object(a.jsxs)(K.a,{style:{backgroundColor:n},children:[e.isLeader&&Object(a.jsx)(Q.a,{children:Object(a.jsx)(V.a,{})}),Object(a.jsx)(q.a,{inset:!e.isLeader,primary:e.name}),Object(a.jsx)(q.a,{primary:(+e.score).toLocaleString()})]})},"".concat(e.name,"-").concat(t))}))]})]})},Z=function(e){var t=e.socket,n=Object(r.useState)(0),o=Object(j.a)(n,2),s=o[0],i=o[1],l=Object(r.useState)(""),d=Object(j.a)(l,2),u=d[0],b=d[1],O=Object(r.useState)([]),m=Object(j.a)(O,2),g=m[0],x=m[1],f=Object(r.useState)(!1),p=Object(j.a)(f,2),v=p[0],C=p[1],k=Object(r.useState)(!1),w=Object(j.a)(k,2),L=w[0],A=w[1],G=Object(r.useState)([]),D=Object(j.a)(G,2),F=D[0],U=D[1],B=Object(r.useState)(!1),E=Object(j.a)(B,2),W=E[0],z=E[1],J=Object(r.useState)(-1),_=Object(j.a)(J,2),H=_[0],K=_[1],q=Object(r.useState)(void 0),Q=Object(j.a)(q,2),V=Q[0],Z=Q[1],$=Object(r.useState)(60),ee=Object(j.a)($,2),te=ee[0],ne=ee[1],ae=Object(r.useState)("countDownTimer"),re=Object(j.a)(ae,2),ce=re[0],oe=re[1],se=Object(r.useState)(60),ie=Object(j.a)(se,2),le=ie[0],je=ie[1],de=Object(r.useState)(0),ue=Object(j.a)(de,2),be=ue[0],Oe=ue[1],me=Object(r.useState)(0),he=Object(j.a)(me,2),ge=he[0],xe=he[1],fe=Object(r.useState)(!1),pe=Object(j.a)(fe,2),ve=pe[0],ye=pe[1],Se=Object(r.useState)(!1),Ne=Object(j.a)(Se,2),Ce=Ne[0],ke=Ne[1],we=Object(r.useState)(""),Re=Object(j.a)(we,2),Pe=Re[0],Te=Re[1],Ie=Object(r.useState)(""),Le=Object(j.a)(Ie,2),Ae=Le[0],Ge=Le[1],De=Object(r.useState)(!1),Fe=Object(j.a)(De,2),Ue=Fe[0],Be=Fe[1],Ee=Object(r.useState)(!1),We=Object(j.a)(Ee,2),ze=We[0],Me=We[1],Je=y(),Ye=Object(r.useCallback)((function(){oe("countDownTimer"===ce?"countDownTimer2":"countDownTimer"),ne(le),A(!0)}),[ce,le]);Object(r.useEffect)((function(){t&&(!function(e){var t=e.socket,n=e.setGameOver,a=e.setRoomName,r=e.setCurrentRound,c=e.setNumberOfRounds,o=e.setTimePerRound,s=e.setTimerSeconds,i=e.setPlayers,l=e.setCurrentIndex,j=e.setImageUrls,d=e.setImgUrl,u=e.setImageLoaded,b=e.setDistance,O=e.setGuessSent,m=e.startCountDownTimer,h=e.setRoundOver,g=e.setRoundPosition;t.on("handleSendImages",(function(e){n(!1);var t=e.gameData,x=e.players;x=I(x);var f=e.timePerRound,p=e.currentRound,v=e.numberOfRounds,y=e.roomName;a(y),r(p),c(v),o(f),s(f),i(x);var S=[];if(t.features.length>0){for(var N=0;N<t.features.length;N++){var C=t.features[N].properties.key,k="https://images.mapillary.com/".concat(C,"/thumb-2048.jpg");S.push(k)}l(0),j(S),d(S[0]),u(!0),g(void 0),b(-1),O(!1),m(),h(!1)}}))}({socket:t,setGameOver:ye,setRoomName:Te,setCurrentRound:Oe,setNumberOfRounds:xe,setTimePerRound:je,setTimerSeconds:ne,setPlayers:U,setCurrentIndex:i,setImageUrls:x,setImgUrl:b,setImageLoaded:C,setDistance:K,setGuessSent:ke,startCountDownTimer:Ye,setRoundOver:Be,setRoundPosition:Z}),function(e){var t=e.socket,n=e.setPlayerName,a=e.setPlayers,r=e.setRoundPosition,c=e.setDistance,o=e.setIsLeader,s=e.setCountdownStarted,i=e.setRoundOver;t.on("handleRoundOver",(function(e){var t=e.isGameLeader,l=e.correctPosition,j=e.distance,d=e.players,u=e.playerName;n(u),a(d),r(l),c(j),o(t),s(!1),i(!0)}))}({socket:t,setPlayerName:Ge,setPlayers:U,setRoundPosition:Z,setDistance:K,setIsLeader:z,setCountdownStarted:A,setRoundOver:Be}),t.on("handleGameOver",(function(e){var t=e.players;t=I(t),U(t),ye(!0)})),t.on("gameStarted",(function(){ye(!1),K(-1),Me(!1),Be(!1),Z(void 0)})))}),[t,Ye]);var _e=function(){Me(!0),t.emit("handleStartGame",{timePerRound:le,numberOfRounds:ge})},He=function(){return ze?Object(a.jsx)("div",{style:{textAlign:"center"},children:Object(a.jsx)(P.a,{})}):Object(a.jsx)(h.a,{variant:"contained",onClick:_e,className:Je.buttonGreen,children:"Play again"})};return Object(a.jsxs)(S,{children:[ve?Object(a.jsxs)("div",{style:{textAlign:"center"},children:[Object(a.jsx)("h3",{children:"Game Over"}),W?Object(a.jsx)(He,{}):Object(a.jsx)(T.a,{children:"Waiting for leader to start again"})]}):Object(a.jsxs)(c.a.Fragment,{children:[Object(a.jsxs)("div",{id:"info-container",style:{padding:15,textAlign:"center",position:"relevant"},children:[Object(a.jsx)("div",{id:"count-down-container",style:{margin:"auto",position:"absolute",top:90,left:10},children:Object(a.jsx)(R.CountdownCircleTimer,{isPlaying:L,size:70,duration:te,colors:[["#004777",.33],["#F7B801",.33],["#A30000",.33]],children:function(e){return e.remainingTime}},ce)}),Object(a.jsx)("img",{className:Je.icon,src:N,alt:"jjicon"}),Object(a.jsxs)(T.a,{children:["Round ",be," of ",ge]})]}),Object(a.jsx)(Y,{imgUrl:u,imageUrls:g,currentIndex:s,setCurrentIndex:i,setImgUrl:b,guessSent:Ce}),Object(a.jsx)(M,{socket:t,setImageUrls:x,imageLoaded:v,guessSentCallback:function(){C(!1)},isLeader:W,distance:H,roundPosition:V,setGuessSent:ke,guessSent:Ce,players:F,playerName:Ae,roundOver:Ue,setRoundOver:Be})]}),F.length>0&&Object(a.jsx)(X,{players:F,roomName:Pe})]})},$=n(251),ee=n(253),te=function(e){var t=e.socket,n=Object(u.a)(e,["socket"]),o=Object(r.useState)(""),s=Object(j.a)(o,2),i=s[0],l=s[1],d=Object(r.useState)([]),b=Object(j.a)(d,2),O=b[0],g=b[1],x=Object(r.useState)(!1),f=Object(j.a)(x,2),p=f[0],v=f[1],N=Object(r.useState)(5),C=Object(j.a)(N,2),k=C[0],w=C[1],R=Object(r.useState)(60),P=Object(j.a)(R,2),I=P[0],L=P[1],A=Object(r.useState)(!0),G=Object(j.a)(A,2),D=G[0],F=G[1],U=Object(r.useState)(!1),B=Object(j.a)(U,2),E=B[0],W=(B[1],y());Object(r.useEffect)((function(){t&&(t.emit("connectedToWaitingRoom"),t.once("connectedToWaitingRoomCallback",(function(e){var t=e.roomName,n=e.players,a=e.isLeader;l(t),v(a),g(n)})),t.on("updatePlayers",(function(e){var t=e.players;t&&g(t)})),t.on("gameStarted",(function(){n.history.push(ae)})))}),[t,n.history]);return Object(a.jsx)(S,{children:Object(a.jsxs)(_.a,{elevation:1,className:W.cardContainer,children:[Object(a.jsx)("h3",{children:"Waiting room"}),Object(a.jsxs)("h5",{children:["Room ",i]}),Object(a.jsxs)(T.a,{children:["To play with your friends, tell them to write '",i,"' in the room inputbox and press connect!"]}),Object(a.jsx)(T.a,{children:"Players in room"}),Object(a.jsx)(H.a,{style:{width:200,margin:"auto"},children:O.map((function(e,t){return Object(a.jsx)(c.a.Fragment,{children:Object(a.jsxs)(K.a,{children:[Object(a.jsx)(q.a,{children:e.name}),e.isLeader?Object(a.jsx)(Q.a,{children:Object(a.jsx)(V.a,{})}):Object(a.jsx)(q.a,{})]})},"".concat(e.name,"-").concat(t))}))}),p?Object(a.jsxs)(c.a.Fragment,{children:[Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(T.a,{children:"Number of Rounds"}),Object(a.jsx)(m.a,{id:"numberofrounds-text-field",type:"number",placeholder:"Number of rounds",value:k,onChange:function(e){return w(e.target.value)}}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(T.a,{children:"Seconds per round"}),Object(a.jsx)(m.a,{id:"timeperround-text-field",type:"number",placeholder:"seconds per round",value:I,onChange:function(e){return L(e.target.value)}}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)($.a,{control:Object(a.jsx)(ee.a,{checked:D,onChange:function(){F(!D)}}),label:"Use only panoramas?"}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(h.a,{onClick:function(){isNaN(+I)||isNaN(+k)||t.emit("handleStartGame",{timePerRound:I,numberOfRounds:k,onlyPano:D,onlyEuropeUsa:E})},variant:"contained",className:W.buttonGreen,children:"Start Game"})]}):Object(a.jsx)(T.a,{children:"Waiting for leader to start the game."})]})})},ne={ENDPOINT:window.location.hostname}.ENDPOINT,ae="/game",re="/waitingroom",ce=function(){var e=Object(r.useState)(void 0),t=Object(j.a)(e,2),n=t[0],c=t[1];return Object(r.useEffect)((function(){var e=w.a.connect(ne);c(e),e.on("connectedToRoomCallBack",(function(e){}))}),[]),Object(a.jsxs)(d.c,{children:[Object(a.jsx)(d.a,{exact:!0,path:"/",render:function(e){return Object(a.jsx)(C,Object(l.a)(Object(l.a)({},e),{},{socket:n}))}}),Object(a.jsx)(d.a,{path:ae,render:function(e){return Object(a.jsx)(Z,Object(l.a)(Object(l.a)({},e),{},{socket:n}))}}),Object(a.jsx)(d.a,{path:re,render:function(e){return Object(a.jsx)(te,Object(l.a)(Object(l.a)({},e),{},{socket:n}))}})]})};n(202);var oe=function(){return Object(a.jsx)(i.a,{basename:"/jeojuessr",children:Object(a.jsx)(ce,{})})},se=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,257)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),a(e),r(e),c(e),o(e)}))};s.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(oe,{})}),document.getElementById("root")),se()}},[[203,1,2]]]);
//# sourceMappingURL=main.f34cc64e.chunk.js.map