(this["webpackJsonpmap-game-client"]=this["webpackJsonpmap-game-client"]||[]).push([[0],{137:function(e,t,n){},170:function(e,t){},192:function(e,t,n){},195:function(e,t,n){},196:function(e,t,n){"use strict";n.r(t);var c=n(3),a=n(0),r=n.n(a),i=n(14),s=n.n(i),o=(n(137),n(121)),j=n(20),l=n(12),b=n(16),d=n(24),u=n(239),O=n(229),h=function(e){var t=e.socket,n=Object(d.a)(e,["socket"]),r=Object(a.useState)(""),i=Object(l.a)(r,2),s=i[0],o=i[1],j=Object(a.useState)(""),b=Object(l.a)(j,2),h=b[0],x=b[1];return Object(c.jsx)("div",{children:Object(c.jsxs)("div",{style:{textAlign:"center"},children:[Object(c.jsx)("h2",{children:"Map game"}),Object(c.jsx)("p",{children:"Still in development"}),Object(c.jsxs)("div",{style:{margin:"auto",width:400},children:[Object(c.jsx)("p",{children:"Please write in 'Room Name' anything, then tell your friends to write the same thing to play together. Or you can play by yourself."}),Object(c.jsx)("p",{children:"This is in development so there are probably hella bugs. ToDo: add leaderboard. Make finding new positions better. Using open street maps and Mapillary."})]}),Object(c.jsx)(u.a,{id:"player-text-field",placeholder:"Name",value:h,onChange:function(e){return x(e.target.value)}}),Object(c.jsx)("br",{}),Object(c.jsx)("br",{}),Object(c.jsx)(u.a,{id:"room-text-field",placeholder:"Room Name",value:s,onChange:function(e){return o(e.target.value)}}),Object(c.jsx)("br",{}),Object(c.jsx)("br",{}),Object(c.jsx)(O.a,{variant:"outlined",onClick:function(){""!==s&&""!==h&&(t.emit("roomConnection",{roomName:s,playerName:h}),n.history.push(U))},children:"Connect"})]})})},x=n(110),m=n.n(x),g=n(122),f=n(117),p=n(66),v=n(234),y=n(228),S=n(235),k=n(236),w=n(237),N=n(238),C=(n(192),n(27)),R=n.n(C),P=n(118),A=(n(193),n(119)),T=n(230),F=n(231),L=n(232),D=n(233),G=n(240),B=function(e){var t=e.socket,n=e.setImageUrls,i=e.imageLoaded,s=e.guessSentCallback,o=e.isLeader,j=e.distance,b=e.roundPosition,d=e.setGuessSent,u=e.guessSent,h=Object(a.useState)({lat:51.505,lng:-.09}),x=Object(l.a)(h,2),m=x[0],g=x[1],f=function(e){return R.a.icon({iconUrl:e?P.a:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-yellow.png",shadowUrl:A.a,iconSize:[25,41],iconAnchor:[10,41]})},v=function(){return b?Object(c.jsx)(T.a,{icon:f(!0),position:b}):null},y=function(){return b?Object(c.jsx)(F.a,{positions:[[b.lat,b.lng],[m.lat,m.lng]]}):null},S=function(){return Object(L.a)({click:function(e){console.log("map clicked",e.latlng),g({lat:e.latlng.lat,lng:e.latlng.lng})}}),Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(T.a,{icon:f(!1),position:m}),Object(c.jsx)(v,{}),Object(c.jsx)(y,{})]})};return Object(c.jsxs)("div",{style:{padding:20},children:[Object(c.jsxs)(D.a,{center:[51.505,-.09],zoom:2,style:{height:400,width:"70%",margin:"auto",marginBottom:15},children:[Object(c.jsx)(S,{}),Object(c.jsx)(G.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager_labels_under/{z}/{x}/{y}.png"})]}),b&&Object(c.jsx)(r.a.Fragment,{children:-1!==j?Object(c.jsxs)(p.a,{style:{textAlign:"center"},children:["You were ",j.toLocaleString()," KM from the correct position."]}):Object(c.jsx)(p.a,{style:{textAlign:"center"},children:"You did not guess this round."})}),i&&!b&&Object(c.jsx)("div",{style:{textAlign:"center",paddingBottom:20},children:Object(c.jsx)(O.a,{onClick:function(){s(),d(!0),t.emit("handleSendGuess",{position:{lat:m.lat,lng:m.lng}})},variant:"contained",children:"Send"})}),u&&!b&&Object(c.jsx)("div",{style:{textAlign:"center"},children:Object(c.jsx)(p.a,{children:"Waiting for other players to finish."})}),u&&b&&Object(c.jsx)(r.a.Fragment,{children:o?Object(c.jsx)("div",{style:{textAlign:"center",paddingBottom:20},children:Object(c.jsx)(O.a,{onClick:function(){t.emit("handleStartNextRound",{}),n([]),d(!1)},variant:"contained",children:"Start next round"})}):Object(c.jsx)("div",{style:{textAlign:"center",paddingBottom:20},children:Object(c.jsx)(p.a,{children:"Waiting for leader to start next round"})})})]})},W=function(e){var t=e.socket,n=Object(a.useState)(0),i=Object(l.a)(n,2),s=i[0],o=i[1],j=Object(a.useState)(""),b=Object(l.a)(j,2),d=b[0],u=b[1],h=Object(a.useState)([]),x=Object(l.a)(h,2),m=x[0],C=x[1],R=Object(a.useState)(!1),P=Object(l.a)(R,2),A=P[0],T=P[1],F=Object(a.useState)(!1),L=Object(l.a)(F,2),D=L[0],G=L[1],W=Object(a.useState)([]),I=Object(l.a)(W,2),E=I[0],M=I[1],U=Object(a.useState)(!1),z=Object(l.a)(U,2),J=z[0],K=z[1],Y=Object(a.useState)(-1),_=Object(l.a)(Y,2),q=_[0],H=_[1],Q=Object(a.useState)(void 0),V=Object(l.a)(Q,2),X=V[0],Z=V[1],$=Object(a.useState)(60),ee=Object(l.a)($,2),te=ee[0],ne=ee[1],ce=Object(a.useState)("countDownTimer"),ae=Object(l.a)(ce,2),re=ae[0],ie=ae[1],se=Object(a.useState)(60),oe=Object(l.a)(se,2),je=oe[0],le=oe[1],be=Object(a.useState)(0),de=Object(l.a)(be,2),ue=de[0],Oe=de[1],he=Object(a.useState)(0),xe=Object(l.a)(he,2),me=xe[0],ge=xe[1],fe=Object(a.useState)(!1),pe=Object(l.a)(fe,2),ve=pe[0],ye=pe[1],Se=Object(a.useState)(!1),ke=Object(l.a)(Se,2),we=ke[0],Ne=ke[1],Ce=Object(a.useState)(""),Re=Object(l.a)(Ce,2),Pe=Re[0],Ae=Re[1];Object(a.useEffect)((function(){t&&(t.on("handleSendImages",(function(e){ye(!1);var t=e.gameData,n=e.players,c=e.timePerRound,a=e.currentRound,r=e.numberOfRounds,i=e.roomName;Ae(i),Oe(a),ge(r),le(c),ne(c),M(n);var s=[];if(t.features.length>0){for(var j=0;j<t.features.length;j++){var l=t.features[j].properties.key,b="https://images.mapillary.com/".concat(l,"/thumb-2048.jpg");s.push(b)}o(0),C(s),u(s[0]),T(!0),Z(void 0),H(-1),Ne(!1),ie("countDownTimer"===re?"countDownKey":"countDownTimer"),ne(je),G(!0)}})),t.on("handleRoundOver",(function(e){var t=e.isGameLeader,n=e.correctPosition,c=e.distance;Z(n),H(c),Ne(!0),K(t),C([])})),t.on("handleGameOver",(function(e){var t=e.players;M(t),ye(!0)})))}),[t]);var Te=function(e){u(m[e])};return Object(c.jsxs)("div",{children:[ve?Object(c.jsxs)("div",{style:{textAlign:"center"},children:[Object(c.jsx)("h3",{children:"Game Over"}),J?Object(c.jsx)(O.a,{variant:"outlined",onClick:function(){t.emit("handleStartGame",{timePerRound:je,numberOfRounds:me})},children:"Play again"}):Object(c.jsx)(p.a,{children:"Waiting for leader to start again"})]}):Object(c.jsxs)(r.a.Fragment,{children:[Object(c.jsx)("div",{id:"countdown-clock-container",style:{margin:"auto"},children:Object(c.jsx)(f.CountdownCircleTimer,{isPlaying:D,style:{margin:"auto"},size:70,duration:te,colors:[["#004777",.33],["#F7B801",.33],["#A30000",.33]],children:function(e){return e.remainingTime}},re)}),Object(c.jsxs)(p.a,{children:["Round ",ue," of ",me]}),m.length>0?Object(c.jsxs)("div",{className:"pano-container",children:[Object(c.jsxs)(p.a,{style:{textAlign:"center"},children:[s+1," / ",m.length," "]}),Object(c.jsx)("button",{className:"pano-btn",id:"pano-prev-btn",onClick:function(){var e=-1;0===s?(o(m.length-1),e=m.length-1):(o(s-1),e=s-1),Te(e)},children:Object(c.jsx)("i",{className:"arrow arrow-left"})}),Object(c.jsx)("button",{className:"pano-btn arrow-right",id:"pano-next-btn",onClick:function(){var e=-1;s===m.length-1?(e=0,o(0)):(e=s+1,o(s+1)),Te(e)},children:Object(c.jsx)("i",{className:"arrow"})}),Object(c.jsx)(g.a,{width:"100%",height:"500px",image:d,pitch:10,yaw:180,hfov:110,autoLoad:!0})]}):we?Object(c.jsx)(p.a,{style:{textAlign:"center"},children:"Waiting for leader to start round."}):Object(c.jsx)("div",{style:{textAlign:"center"},children:Object(c.jsx)(v.a,{})}),Object(c.jsx)(B,{socket:t,setImageUrls:C,imageLoaded:A,guessSentCallback:function(){T(!1)},isLeader:J,distance:q,roundPosition:X,setGuessSent:Ne,guessSent:we})]}),E.length>0&&Object(c.jsxs)("div",{style:{textAlign:"center"},children:[Object(c.jsxs)(p.a,{children:["Players in room ",Pe]}),Object(c.jsxs)(y.a,{style:{width:200,margin:"auto"},children:[Object(c.jsxs)(S.a,{children:[Object(c.jsx)(k.a,{children:"Score"}),Object(c.jsx)(k.a,{children:"Name"}),Object(c.jsx)(k.a,{})]}),E.map((function(e,t){return Object(c.jsx)(r.a.Fragment,{children:Object(c.jsxs)(S.a,{children:[Object(c.jsx)(k.a,{children:e.score}),Object(c.jsx)(k.a,{children:e.name}),e.isLeader?Object(c.jsx)(w.a,{children:Object(c.jsx)(N.a,{})}):Object(c.jsx)(k.a,{})]})},"".concat(e.name,"-").concat(t))}))]})]})]})},I=function(e){var t=e.socket,n=Object(d.a)(e,["socket"]),i=Object(a.useState)(""),s=Object(l.a)(i,2),o=s[0],j=s[1],b=Object(a.useState)([]),h=Object(l.a)(b,2),x=h[0],m=h[1],g=Object(a.useState)(!1),f=Object(l.a)(g,2),v=f[0],C=f[1],R=Object(a.useState)(5),P=Object(l.a)(R,2),A=P[0],T=P[1],F=Object(a.useState)(60),L=Object(l.a)(F,2),D=L[0],G=L[1];Object(a.useEffect)((function(){t&&(t.emit("connectedToWaitingRoom"),t.once("connectedToWaitingRoomCallback",(function(e){var t=e.roomName,n=e.players,c=e.isLeader;j(t),C(c),m(n)})),t.on("updatePlayers",(function(e){var t=e.players;t&&m(t)})),t.on("gameStarted",(function(){n.history.push(M)})))}),[t,n.history]);return Object(c.jsxs)("div",{style:{textAlign:"center"},children:[Object(c.jsx)("h3",{children:"Waiting room"}),Object(c.jsxs)("h5",{children:["Room ",o]}),Object(c.jsx)(p.a,{children:"Players in room"}),Object(c.jsx)(y.a,{style:{width:200,margin:"auto"},children:x.map((function(e,t){return Object(c.jsx)(r.a.Fragment,{children:Object(c.jsxs)(S.a,{children:[Object(c.jsx)(k.a,{children:e.name}),e.isLeader?Object(c.jsx)(w.a,{children:Object(c.jsx)(N.a,{})}):Object(c.jsx)(k.a,{})]})},"".concat(e.name,"-").concat(t))}))}),v?Object(c.jsxs)(r.a.Fragment,{children:[Object(c.jsx)("br",{}),Object(c.jsx)("br",{}),Object(c.jsx)(p.a,{children:"Number of Rounds"}),Object(c.jsx)(u.a,{id:"numberofrounds-text-field",type:"number",placeholder:"Number of rounds",value:A,onChange:function(e){return T(e.target.value)}}),Object(c.jsx)("br",{}),Object(c.jsx)("br",{}),Object(c.jsx)(p.a,{children:"Seconds per round"}),Object(c.jsx)(u.a,{id:"timeperround-text-field",type:"number",placeholder:"seconds per round",value:D,onChange:function(e){return G(e.target.value)}}),Object(c.jsx)("br",{}),Object(c.jsx)("br",{}),Object(c.jsx)(O.a,{onClick:function(){isNaN(+D)||isNaN(+A)||t.emit("handleStartGame",{timePerRound:D,numberOfRounds:A})},variant:"outlined",children:"Start Game"})]}):Object(c.jsx)(p.a,{children:"Waiting for leader to start the game."})]})},E={ENDPOINT:window.location.hostname}.ENDPOINT,M="/game",U="/waitingroom",z=function(){var e=Object(a.useState)(void 0),t=Object(l.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){var e=m.a.connect(E);r(e),e.on("connectedToRoomCallBack",(function(e){}))}),[]),Object(c.jsxs)(b.c,{children:[Object(c.jsx)(b.a,{exact:!0,path:"/",render:function(e){return Object(c.jsx)(h,Object(j.a)(Object(j.a)({},e),{},{socket:n}))}}),Object(c.jsx)(b.a,{path:M,render:function(e){return Object(c.jsx)(W,Object(j.a)(Object(j.a)({},e),{},{socket:n}))}}),Object(c.jsx)(b.a,{path:U,render:function(e){return Object(c.jsx)(I,Object(j.a)(Object(j.a)({},e),{},{socket:n}))}})]})};n(195);var J=function(){return Object(c.jsx)(o.a,{basename:"/map-game",children:Object(c.jsx)(z,{})})},K=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,242)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),c(e),a(e),r(e),i(e)}))};s.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(J,{})}),document.getElementById("root")),K()}},[[196,1,2]]]);
//# sourceMappingURL=main.4a0fd111.chunk.js.map