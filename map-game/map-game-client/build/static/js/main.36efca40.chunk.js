(this["webpackJsonpmap-game-client"]=this["webpackJsonpmap-game-client"]||[]).push([[0],{137:function(e,t,n){},170:function(e,t){},192:function(e,t,n){},195:function(e,t,n){},196:function(e,t,n){"use strict";n.r(t);var c=n(3),a=n(0),r=n.n(a),i=n(14),s=n.n(i),o=(n(137),n(122)),j=n(20),l=n(12),b=n(16),d=n(25),u=n(240),O=n(229),h=function(e){var t=e.socket,n=Object(d.a)(e,["socket"]),r=Object(a.useState)(""),i=Object(l.a)(r,2),s=i[0],o=i[1],j=Object(a.useState)(""),b=Object(l.a)(j,2),h=b[0],m=b[1];return Object(c.jsx)("div",{children:Object(c.jsxs)("div",{style:{textAlign:"center"},children:[Object(c.jsx)("h2",{children:"Map game"}),Object(c.jsx)("p",{children:"Still in development"}),Object(c.jsxs)("div",{style:{margin:"auto",width:400},children:[Object(c.jsx)("p",{children:"Please write in 'Room Name' anything, then tell your friends to write the same thing to play together. Or you can play by yourself."}),Object(c.jsx)("p",{children:"This is in development so there are probably hella bugs. ToDo: add leaderboard. Make finding new positions better. Using open street maps and Mapillary."})]}),Object(c.jsx)(u.a,{id:"player-text-field",placeholder:"Name",value:h,onChange:function(e){return m(e.target.value)}}),Object(c.jsx)("br",{}),Object(c.jsx)("br",{}),Object(c.jsx)(u.a,{id:"room-text-field",placeholder:"Room Name",value:s,onChange:function(e){return o(e.target.value)}}),Object(c.jsx)("br",{}),Object(c.jsx)("br",{}),Object(c.jsx)(O.a,{variant:"outlined",onClick:function(){""!==s&&""!==h&&(t.emit("roomConnection",{roomName:s,playerName:h}),n.history.push(z))},children:"Connect"})]})})},m=n(111),x=n.n(m),g=n(123),p=n(118),f=n(66),y=n(235),v=n(228),S=n(236),k=n(237),w=n(238),N=n(239),C=(n(192),n(22)),P=n.n(C),R=n(119),A=(n(193),n(120)),T=n(230),F=n(231),L=n(232),D=n(233),G=n(234),B=n(241),W=function(e){var t=e.socket,n=e.setImageUrls,i=e.imageLoaded,s=e.guessSentCallback,o=e.isLeader,j=e.distance,b=e.roundPosition,d=e.setGuessSent,u=e.guessSent,h=e.players,m=e.playerName,x=Object(a.useState)({lat:51.505,lng:-.09}),g=Object(l.a)(x,2),p=g[0],y=g[1],v=function(e){return P.a.icon({iconUrl:e?R.a:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-yellow.png",shadowUrl:A.a,iconSize:[25,41],iconAnchor:[10,41]})},S=function(){return b?Object(c.jsx)(T.a,{icon:v(!0),position:b}):null},k=function(){return b?Object(c.jsx)(F.a,{positions:[[b.lat,b.lng],[p.lat,p.lng]]}):null};console.log("players",h);var w=function(){return Object(L.a)({click:function(e){console.log("map clicked",e.latlng),y({lat:e.latlng.lat,lng:e.latlng.lng})}}),Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(T.a,{icon:v(!1),position:p}),u&&Object(c.jsx)(S,{}),u&&Object(c.jsx)(k,{}),h.map((function(e){return e.markerPosition&&e.name!==m?Object(c.jsx)(T.a,{icon:P.a.icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-grey.png",iconSize:[25,41],iconAnchor:[10,41]}),position:e.markerPosition,children:Object(c.jsx)(D.a,{children:e.name})},e.name):null}))]})};return Object(c.jsxs)("div",{style:{padding:20},children:[Object(c.jsxs)(G.a,{center:[51.505,-.09],zoom:2,style:{height:400,width:"70%",margin:"auto",marginBottom:15},children:[Object(c.jsx)(w,{}),Object(c.jsx)(B.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager_labels_under/{z}/{x}/{y}.png"})]}),b&&Object(c.jsx)(r.a.Fragment,{children:-1!==j?Object(c.jsxs)(f.a,{style:{textAlign:"center"},children:["You were ",j.toLocaleString()," KM from the correct position."]}):Object(c.jsx)(f.a,{style:{textAlign:"center"},children:"You did not guess this round."})}),Object(c.jsx)("br",{}),i&&!b&&Object(c.jsx)("div",{style:{textAlign:"center",paddingBottom:20},children:Object(c.jsx)(O.a,{onClick:function(){s(),d(!0),t.emit("handleSendGuess",{position:{lat:p.lat,lng:p.lng}})},variant:"contained",children:"Send"})}),u&&!b&&Object(c.jsx)("div",{style:{textAlign:"center"},children:Object(c.jsx)(f.a,{children:"Waiting for other players to finish."})}),u&&b&&Object(c.jsx)(r.a.Fragment,{children:o?Object(c.jsx)("div",{style:{textAlign:"center",paddingBottom:20},children:Object(c.jsx)(O.a,{onClick:function(){t.emit("handleStartNextRound",{}),n([]),d(!1)},variant:"contained",children:"Start next round"})}):Object(c.jsx)("div",{style:{textAlign:"center",paddingBottom:20},children:Object(c.jsx)(f.a,{children:"Waiting for leader to start next round"})})})]})},I=function(e){var t=e.socket,n=Object(a.useState)(0),i=Object(l.a)(n,2),s=i[0],o=i[1],j=Object(a.useState)(""),b=Object(l.a)(j,2),d=b[0],u=b[1],h=Object(a.useState)([]),m=Object(l.a)(h,2),x=m[0],C=m[1],P=Object(a.useState)(!1),R=Object(l.a)(P,2),A=R[0],T=R[1],F=Object(a.useState)(!1),L=Object(l.a)(F,2),D=L[0],G=L[1],B=Object(a.useState)([]),I=Object(l.a)(B,2),E=I[0],M=I[1],U=Object(a.useState)(!1),z=Object(l.a)(U,2),J=z[0],K=z[1],Y=Object(a.useState)(-1),_=Object(l.a)(Y,2),q=_[0],H=_[1],Q=Object(a.useState)(void 0),V=Object(l.a)(Q,2),X=V[0],Z=V[1],$=Object(a.useState)(60),ee=Object(l.a)($,2),te=ee[0],ne=ee[1],ce=Object(a.useState)("countDownTimer"),ae=Object(l.a)(ce,2),re=ae[0],ie=ae[1],se=Object(a.useState)(60),oe=Object(l.a)(se,2),je=oe[0],le=oe[1],be=Object(a.useState)(0),de=Object(l.a)(be,2),ue=de[0],Oe=de[1],he=Object(a.useState)(0),me=Object(l.a)(he,2),xe=me[0],ge=me[1],pe=Object(a.useState)(!1),fe=Object(l.a)(pe,2),ye=fe[0],ve=fe[1],Se=Object(a.useState)(!1),ke=Object(l.a)(Se,2),we=ke[0],Ne=ke[1],Ce=Object(a.useState)(""),Pe=Object(l.a)(Ce,2),Re=Pe[0],Ae=Pe[1],Te=Object(a.useState)(""),Fe=Object(l.a)(Te,2),Le=Fe[0],De=Fe[1];Object(a.useEffect)((function(){t&&(t.on("handleSendImages",(function(e){ve(!1);var t=e.gameData,n=e.players,c=e.timePerRound,a=e.currentRound,r=e.numberOfRounds,i=e.roomName;Ae(i),Oe(a),ge(r),le(c),ne(c),M(n);var s=[];if(t.features.length>0){for(var j=0;j<t.features.length;j++){var l=t.features[j].properties.key,b="https://images.mapillary.com/".concat(l,"/thumb-2048.jpg");s.push(b)}o(0),C(s),u(s[0]),T(!0),Z(void 0),H(-1),Ne(!1),ie("countDownTimer"===re?"countDownKey":"countDownTimer"),ne(je),G(!0)}})),t.on("handleRoundOver",(function(e){var t=e.isGameLeader,n=e.correctPosition,c=e.distance,a=e.players,r=e.playerName;De(r),M(a),Z(n),H(c),Ne(!0),K(t),C([])})),t.on("handleGameOver",(function(e){var t=e.players;M(t),ve(!0)})))}),[t]);var Ge=function(e){u(x[e])};return Object(c.jsxs)("div",{children:[ye?Object(c.jsxs)("div",{style:{textAlign:"center"},children:[Object(c.jsx)("h3",{children:"Game Over"}),J?Object(c.jsx)(O.a,{variant:"outlined",onClick:function(){t.emit("handleStartGame",{timePerRound:je,numberOfRounds:xe})},children:"Play again"}):Object(c.jsx)(f.a,{children:"Waiting for leader to start again"})]}):Object(c.jsxs)(r.a.Fragment,{children:[Object(c.jsxs)("div",{id:"countdown-clock-container",style:{padding:15},children:[Object(c.jsx)(p.CountdownCircleTimer,{isPlaying:D,style:{margin:"auto"},size:70,duration:te,colors:[["#004777",.33],["#F7B801",.33],["#A30000",.33]],children:function(e){return e.remainingTime}},re),Object(c.jsxs)(f.a,{children:["Round ",ue," of ",xe]})]}),x.length>0?Object(c.jsxs)("div",{className:"pano-container",children:[Object(c.jsxs)(f.a,{style:{textAlign:"center"},children:[s+1," / ",x.length," "]}),Object(c.jsx)("button",{className:"pano-btn",id:"pano-prev-btn",onClick:function(){var e=-1;0===s?(o(x.length-1),e=x.length-1):(o(s-1),e=s-1),Ge(e)},children:Object(c.jsx)("i",{className:"arrow arrow-left"})}),Object(c.jsx)("button",{className:"pano-btn arrow-right",id:"pano-next-btn",onClick:function(){var e=-1;s===x.length-1?(e=0,o(0)):(e=s+1,o(s+1)),Ge(e)},children:Object(c.jsx)("i",{className:"arrow"})}),Object(c.jsx)(g.a,{width:"100%",height:"500px",image:d,pitch:10,yaw:180,hfov:110,autoLoad:!0})]}):we?Object(c.jsx)(f.a,{style:{textAlign:"center"},children:"Waiting for leader to start round."}):Object(c.jsx)("div",{style:{textAlign:"center"},children:Object(c.jsx)(y.a,{})}),Object(c.jsx)(W,{socket:t,setImageUrls:C,imageLoaded:A,guessSentCallback:function(){T(!1)},isLeader:J,distance:q,roundPosition:X,setGuessSent:Ne,guessSent:we,players:E,playerName:Le})]}),E.length>0&&Object(c.jsxs)("div",{style:{textAlign:"center"},children:[Object(c.jsxs)(f.a,{children:["Players in room ",Re]}),Object(c.jsxs)(v.a,{style:{width:200,margin:"auto"},children:[Object(c.jsxs)(S.a,{children:[Object(c.jsx)(k.a,{children:"Score"}),Object(c.jsx)(k.a,{children:"Name"}),Object(c.jsx)(k.a,{})]}),E.map((function(e,t){return Object(c.jsx)(r.a.Fragment,{children:Object(c.jsxs)(S.a,{children:[Object(c.jsx)(k.a,{children:e.score}),Object(c.jsx)(k.a,{children:e.name}),e.isLeader?Object(c.jsx)(w.a,{children:Object(c.jsx)(N.a,{})}):Object(c.jsx)(k.a,{})]})},"".concat(e.name,"-").concat(t))}))]})]}),Object(c.jsx)("br",{})]})},E=function(e){var t=e.socket,n=Object(d.a)(e,["socket"]),i=Object(a.useState)(""),s=Object(l.a)(i,2),o=s[0],j=s[1],b=Object(a.useState)([]),h=Object(l.a)(b,2),m=h[0],x=h[1],g=Object(a.useState)(!1),p=Object(l.a)(g,2),y=p[0],C=p[1],P=Object(a.useState)(5),R=Object(l.a)(P,2),A=R[0],T=R[1],F=Object(a.useState)(60),L=Object(l.a)(F,2),D=L[0],G=L[1];Object(a.useEffect)((function(){t&&(t.emit("connectedToWaitingRoom"),t.once("connectedToWaitingRoomCallback",(function(e){var t=e.roomName,n=e.players,c=e.isLeader;j(t),C(c),x(n)})),t.on("updatePlayers",(function(e){var t=e.players;t&&x(t)})),t.on("gameStarted",(function(){n.history.push(U)})))}),[t,n.history]);return Object(c.jsxs)("div",{style:{textAlign:"center"},children:[Object(c.jsx)("h3",{children:"Waiting room"}),Object(c.jsxs)("h5",{children:["Room ",o]}),Object(c.jsx)(f.a,{children:"Players in room"}),Object(c.jsx)(v.a,{style:{width:200,margin:"auto"},children:m.map((function(e,t){return Object(c.jsx)(r.a.Fragment,{children:Object(c.jsxs)(S.a,{children:[Object(c.jsx)(k.a,{children:e.name}),e.isLeader?Object(c.jsx)(w.a,{children:Object(c.jsx)(N.a,{})}):Object(c.jsx)(k.a,{})]})},"".concat(e.name,"-").concat(t))}))}),y?Object(c.jsxs)(r.a.Fragment,{children:[Object(c.jsx)("br",{}),Object(c.jsx)("br",{}),Object(c.jsx)(f.a,{children:"Number of Rounds"}),Object(c.jsx)(u.a,{id:"numberofrounds-text-field",type:"number",placeholder:"Number of rounds",value:A,onChange:function(e){return T(e.target.value)}}),Object(c.jsx)("br",{}),Object(c.jsx)("br",{}),Object(c.jsx)(f.a,{children:"Seconds per round"}),Object(c.jsx)(u.a,{id:"timeperround-text-field",type:"number",placeholder:"seconds per round",value:D,onChange:function(e){return G(e.target.value)}}),Object(c.jsx)("br",{}),Object(c.jsx)("br",{}),Object(c.jsx)(O.a,{onClick:function(){isNaN(+D)||isNaN(+A)||t.emit("handleStartGame",{timePerRound:D,numberOfRounds:A})},variant:"outlined",children:"Start Game"})]}):Object(c.jsx)(f.a,{children:"Waiting for leader to start the game."})]})},M={ENDPOINT:window.location.hostname}.ENDPOINT,U="/game",z="/waitingroom",J=function(){var e=Object(a.useState)(void 0),t=Object(l.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){var e=x.a.connect(M);r(e),e.on("connectedToRoomCallBack",(function(e){}))}),[]),Object(c.jsxs)(b.c,{children:[Object(c.jsx)(b.a,{exact:!0,path:"/",render:function(e){return Object(c.jsx)(h,Object(j.a)(Object(j.a)({},e),{},{socket:n}))}}),Object(c.jsx)(b.a,{path:U,render:function(e){return Object(c.jsx)(I,Object(j.a)(Object(j.a)({},e),{},{socket:n}))}}),Object(c.jsx)(b.a,{path:z,render:function(e){return Object(c.jsx)(E,Object(j.a)(Object(j.a)({},e),{},{socket:n}))}})]})};n(195);var K=function(){return Object(c.jsx)(o.a,{basename:"/map-game",children:Object(c.jsx)(J,{})})},Y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,243)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),c(e),a(e),r(e),i(e)}))};s.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(K,{})}),document.getElementById("root")),Y()}},[[196,1,2]]]);
//# sourceMappingURL=main.36efca40.chunk.js.map