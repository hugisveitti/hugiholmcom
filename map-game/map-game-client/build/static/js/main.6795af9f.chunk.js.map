{"version":3,"sources":["components/ImageCompontent.jsx","config.js","components/MapComponent.jsx","components/FrontPage.jsx","Routes.jsx","App.js","reportWebVitals.js","index.js"],"names":["ImageComponent","socket","useState","currentIndex","setCurrentIndex","imgUrl","setImgUrl","imageUrls","setImageUrls","useEffect","on","data","myImageUrls","length","i","currKey","url","push","changeImage","newIndex","console","log","className","Typography","style","textAlign","id","onClick","width","height","image","pitch","yaw","hfov","autoLoad","onLoad","CircularProgress","config","ENDPOINT","window","location","hostname","MapComponent","markerPos","setMarkerPos","distance","setDistance","undefined","roundPosition","setRoundPosition","defaultIcon","color","L","icon","iconUrl","shadowUrl","iconShadow","iconSize","iconAnchor","html","MyMarker","useMapEvents","click","e","latlng","lat","lng","Marker","position","CorrectMarker","padding","MapContainer","center","zoom","margin","marginBottom","TileLayer","attribution","toLocaleString","paddingBottom","Button","emit","variant","FrontPage","setSocket","newSocket","socketIOClient","connect","Routes","to","component","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.6795af9f.chunk.js","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { Pannellum } from \"pannellum-react\";\r\nimport \"./ImageComponent.css\";\r\nimport { CircularProgress, Typography } from \"@material-ui/core\";\r\n\r\nconst ImageComponent = ({ socket }) => {\r\n  const getImage = (imageKey) => {\r\n    socket.emit(\"getImageData\", { imageKey });\r\n    socket.on(\"getImage\", (data) => {\r\n      console.log(\"image data\", data);\r\n    });\r\n  };\r\n\r\n  const [currentIndex, setCurrentIndex] = useState(0);\r\n  const [imgUrl, setImgUrl] = useState(\"\");\r\n  const [imageUrls, setImageUrls] = useState([]);\r\n\r\n  // 1024 640 or 2048\r\n  const getImageUrlFromKey = (key) => {\r\n    const _imgUrl = `https://images.mapillary.com/${key}/thumb-2048.jpg`;\r\n    // setImgUrl(_imgUrl);\r\n    return _imgUrl;\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!socket) return;\r\n    socket.on(\"sendSequence\", (data) => {\r\n      const myImageUrls = [];\r\n      if (data[\"features\"].length > 0) {\r\n        for (let i = 0; i < data[\"features\"].length; i++) {\r\n          const item = data[\"features\"][i];\r\n          const currKey = item[\"properties\"][\"key\"];\r\n          const url = getImageUrlFromKey(currKey);\r\n          myImageUrls.push(url);\r\n        }\r\n        setImageUrls(myImageUrls);\r\n        setImgUrl(myImageUrls[0]);\r\n      }\r\n    });\r\n  }, [socket]);\r\n\r\n  const changeImage = (newIndex) => {\r\n    console.log(\"currentIndex\", newIndex);\r\n    console.log(imageUrls[newIndex]);\r\n    setImgUrl(imageUrls[newIndex]);\r\n  };\r\n\r\n  const incIndex = () => {\r\n    let newIndex = -1;\r\n    if (currentIndex === imageUrls.length - 1) {\r\n      setCurrentIndex(0);\r\n      newIndex = 0;\r\n    } else {\r\n      setCurrentIndex(currentIndex + 1);\r\n      newIndex = currentIndex + 1;\r\n    }\r\n    changeImage(newIndex);\r\n  };\r\n\r\n  const decIndex = () => {\r\n    let newIndex = -1;\r\n    if (currentIndex === 0) {\r\n      setCurrentIndex(imageUrls.length - 1);\r\n      newIndex = imageUrls.length - 1;\r\n    } else {\r\n      setCurrentIndex(currentIndex - 1);\r\n      newIndex = currentIndex - 1;\r\n    }\r\n    changeImage(newIndex);\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h4>Image component</h4>\r\n      {imageUrls.length > 0 ? (\r\n        <div className=\"pano-container\">\r\n          <Typography style={{ textAlign: \"center\" }}>\r\n            {currentIndex + 1} / {imageUrls.length}{\" \"}\r\n          </Typography>\r\n          <button className=\"pano-btn\" id=\"pano-prev-btn\" onClick={decIndex}>\r\n            <i className=\"arrow arrow-left\"></i>\r\n          </button>\r\n          <button\r\n            className=\"pano-btn arrow-right\"\r\n            id=\"pano-next-btn\"\r\n            onClick={incIndex}\r\n          >\r\n            <i className=\"arrow\"></i>\r\n          </button>\r\n\r\n          <Pannellum\r\n            width=\"100%\"\r\n            height=\"500px\"\r\n            image={imgUrl}\r\n            pitch={10}\r\n            yaw={180}\r\n            hfov={110}\r\n            autoLoad\r\n            onLoad={() => {\r\n              console.log(\"panorama loaded\");\r\n            }}\r\n          />\r\n        </div>\r\n      ) : (\r\n        <div style={{ textAlign: \"center\" }}>\r\n          <CircularProgress />\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ImageComponent;\r\n","export const config = {\r\n  ENDPOINT:\r\n    process.env.NODE_ENV === \"production\"\r\n      ? window.location.hostname\r\n      : \"http://localhost:8000\",\r\n};\r\n","import React, { useEffect, useState } from \"react\";\r\nimport L from \"leaflet\";\r\nimport icon from \"leaflet/dist/images/marker-icon.png\";\r\nimport \"leaflet/dist/leaflet.css\";\r\nimport iconShadow from \"leaflet/dist/images/marker-shadow.png\";\r\nimport {\r\n  MapContainer,\r\n  TileLayer,\r\n  Marker,\r\n  Popup,\r\n  useMapEvents,\r\n} from \"react-leaflet\";\r\nimport { Button, Typography } from \"@material-ui/core\";\r\n\r\nconst MapComponent = ({ socket }) => {\r\n  const position = [51.505, -0.09];\r\n  const [markerPos, setMarkerPos] = useState([51.505, -0.09]);\r\n\r\n  const [distance, setDistance] = useState(-1);\r\n  const [roundPosition, setRoundPosition] = useState(undefined);\r\n\r\n  useEffect(() => {\r\n    if (!socket) return;\r\n    socket.on(\"handleCorrectPosition\", (data) => {\r\n      setDistance(+data[\"distance\"]);\r\n      setRoundPosition(data[\"correctPosition\"]);\r\n    });\r\n  }, [socket]);\r\n  const defaultIcon = (color) =>\r\n    L.icon({\r\n      iconUrl: icon,\r\n      shadowUrl: iconShadow,\r\n      iconSize: [25, 41],\r\n      iconAnchor: [10, 41],\r\n      html: `<span style=\"background-color:${color}\" />`,\r\n    });\r\n\r\n  const MyMarker = () => {\r\n    useMapEvents({\r\n      click(e) {\r\n        console.log(\"map cliiiick\", e);\r\n        setMarkerPos([e.latlng.lat, e.latlng.lng]);\r\n      },\r\n    });\r\n    return <Marker icon={defaultIcon(\"blue\")} position={markerPos} />;\r\n  };\r\n\r\n  const CorrectMarker = () => {\r\n    if (!roundPosition) return null;\r\n    return <Marker icon={defaultIcon(\"green\")} position={roundPosition} />;\r\n  };\r\n\r\n  const handleGuessSent = () => {\r\n    socket.emit(\"handleSendGuess\", {\r\n      position: { lat: markerPos[0], lng: markerPos[1] },\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div style={{ padding: 20 }}>\r\n      <MapContainer\r\n        center={position}\r\n        zoom={2}\r\n        style={{\r\n          height: 400,\r\n          width: \"70%\",\r\n          // minWidth: 275,\r\n          margin: \"auto\",\r\n          marginBottom: 15,\r\n        }}\r\n      >\r\n        <MyMarker />\r\n        <CorrectMarker />\r\n        <TileLayer\r\n          attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n        />\r\n      </MapContainer>\r\n      {distance !== -1 && (\r\n        <Typography style={{ textAlign: \"center\" }}>\r\n          You were {distance.toLocaleString()} KM from the correct position.\r\n        </Typography>\r\n      )}\r\n      <div style={{ textAlign: \"center\", paddingBottom: 20 }}>\r\n        <Button onClick={handleGuessSent} variant=\"contained\">\r\n          Send\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MapComponent;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport socketIOClient from \"socket.io-client\";\r\nimport ImageComponent from \"./ImageCompontent\";\r\nimport { config } from \"../config\";\r\nimport MapComponent from \"./MapComponent\";\r\n\r\nconst ENDPOINT = config.ENDPOINT;\r\nconst FrontPage = () => {\r\n  const [socket, setSocket] = useState(undefined);\r\n  console.log(\"config\", config);\r\n  useEffect(() => {\r\n    const newSocket = socketIOClient.connect(ENDPOINT);\r\n    setSocket(newSocket);\r\n    newSocket.on(\"connectedToRoomCallBack\", (data) => {\r\n      console.log(\"callback\", data);\r\n    });\r\n  }, []);\r\n\r\n  return (\r\n    <div>\r\n      <h2>Frontpage</h2>\r\n      <ImageComponent socket={socket} />\r\n      <MapComponent socket={socket} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FrontPage;\r\n","import React from \"react\";\r\nimport { Route, Switch } from \"react-router\";\r\nimport FrontPage from \"./components/FrontPage\";\r\n\r\nexport const frontPagePath = \"/\";\r\n\r\nconst Routes = () => {\r\n  return (\r\n    <Switch>\r\n      <Route to={frontPagePath} component={FrontPage} />\r\n    </Switch>\r\n  );\r\n};\r\n\r\nexport default Routes;\r\n","import { BrowserRouter } from \"react-router-dom\";\nimport Routes from \"./Routes\";\nimport \"./App.css\";\n\nfunction App() {\n  return (\n    <BrowserRouter>\n      <Routes />\n    </BrowserRouter>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}