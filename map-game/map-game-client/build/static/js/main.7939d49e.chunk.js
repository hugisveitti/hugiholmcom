(this["webpackJsonpmap-game-client"]=this["webpackJsonpmap-game-client"]||[]).push([[0],{113:function(e,t,n){},151:function(e,t,n){},152:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n(0),r=n.n(c),s=n(11),o=n.n(s),i=(n(113),n(97)),l=n(17),j=n(7),d=n(12),u=n(22),b=n(187),O=n(188),m=n(202),h=n(190),g=n(181),x=n(204),f=n(184),p=n(186),v=["#52BE80","#DAF7A6","#FFC300","#FF5733","#2C3E50","#5D6D7E"],y=Object(g.a)((function(){return Object(x.a)({root:{flexGrow:1,minHeight:"100vh",position:"relative",backgroundColor:"#D1F2EB"},menuButton:{marginRight:20},title:{flexGrow:1},header:{backgroundColor:v[0]},footer:{backgroundColor:v[0],fontSize:10,margin:"auto",color:"white",position:"absolute",bottom:0,width:"100%",height:"2.5rem",padding:0,marginTop:20},footerContent:{margin:"auto"},container:{paddingTop:20,paddingBottom:100},buttonGreen:{background:v[0],color:"white"},cardContainer:{margin:"auto",width:400,backgroundColor:"#F9EBEA",textAlign:"center",padding:20,marginBottom:20,marginTop:20},icon:{width:"auto",height:60}})})),S=function(e){var t=e.children,n=y();return Object(a.jsxs)("div",{className:n.root,children:[Object(a.jsx)(f.a,{position:"static",children:Object(a.jsx)(p.a,{className:n.header,children:Object(a.jsx)("h3",{children:"JeoJuessr"})})}),Object(a.jsx)("div",{className:n.container,children:t}),Object(a.jsx)(p.a,{className:n.footer,children:Object(a.jsx)("div",{className:n.footerContent,children:"footer stuff"})})]})},N=n.p+"static/media/icon.f293e650.png",k=function(e){var t=e.socket,n=Object(u.a)(e,["socket"]),r=y(),s=Object(c.useState)(""),o=Object(j.a)(s,2),i=o[0],l=o[1],d=Object(c.useState)(""),g=Object(j.a)(d,2),x=g[0],f=g[1];return Object(a.jsx)(S,{children:Object(a.jsxs)("div",{style:{textAlign:"center"},children:[Object(a.jsx)("img",{className:r.icon,src:N,alt:"joejuessrlogo"}),Object(a.jsx)(b.a,{className:r.cardContainer,children:Object(a.jsxs)(O.a,{children:[Object(a.jsx)("p",{children:"Still in development"}),Object(a.jsx)("p",{children:"Please write in 'Room Name' anything, then tell your friends to write the same thing to play together. Or you can play by yourself."}),Object(a.jsx)("p",{children:"This is in development so there are probably hella bugs. ToDo: add leaderboard. Make finding new positions better. Using open street maps and Mapillary."}),Object(a.jsx)(m.a,{id:"player-text-field",placeholder:"Name",value:x,onChange:function(e){return f(e.target.value)}}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(m.a,{id:"room-text-field",placeholder:"Room Name",value:i,onChange:function(e){return l(e.target.value)}}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(h.a,{className:r.buttonGreen,variant:"contained",onClick:function(){""!==i&&""!==x&&(t.emit("roomConnection",{roomName:i,playerName:x}),n.history.push(ce))},children:"Connect"})]})})]})})},C=n(90),w=n.n(C),R=n(91),P=n(196),T=n(53),I=function(e){return e.sort((function(e,t){return e.score<t.score?1:e.score>t.score?-1:0}))},D=(n(85),n(16)),A=n.n(D),G=n(92),L=(n(147),n(93)),F=n(191),B=n(192),U=n(193),E=n(194),W=n(195),z=n(205),M=function(e){var t=e.socket,n=e.setImageUrls,s=e.imageLoaded,o=e.guessSentCallback,i=e.isLeader,l=e.distance,d=e.roundPosition,u=e.setGuessSent,b=e.guessSent,O=e.players,m=e.playerName,g=e.roundOver,x=e.setRoundOver,f=Object(c.useState)({lat:51.505,lng:-.09}),p=Object(j.a)(f,2),v=p[0],S=p[1],N=y(),k=function(e){return A.a.icon({iconUrl:e?G.a:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-yellow.png",shadowUrl:L.a,iconSize:[25,41],iconAnchor:[10,41]})},C=function(){return d?Object(a.jsx)(F.a,{icon:k(!0),position:d}):null},w=function(){return d?Object(a.jsx)(B.a,{positions:[[d.lat,d.lng],[v.lat,v.lng]]}):null},R=function(){return Object(U.a)({click:function(e){console.log("map clicked",e.latlng),g||S({lat:e.latlng.lat,lng:e.latlng.lng})}}),Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(F.a,{icon:k(!1),position:v}),g&&Object(a.jsx)(C,{}),g&&Object(a.jsx)(w,{}),O.map((function(e){return e.markerPosition&&e.name!==m?Object(a.jsx)(F.a,{icon:A.a.icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-grey.png",iconSize:[25,41],iconAnchor:[10,41]}),position:e.markerPosition,children:Object(a.jsx)(E.a,{children:e.name})},e.name):null}))]})},P=function(){t.emit("handleStartNextRound",{}),n([]),u(!1),x(!1)},I=function(){return b&&d||g?i?Object(a.jsx)("div",{style:{textAlign:"center"},children:Object(a.jsx)(h.a,{onClick:P,variant:"contained",className:N.buttonGreen,children:"Start next round"})}):Object(a.jsx)("div",{style:{textAlign:"center"},children:Object(a.jsx)(T.a,{children:"Waiting for leader to start next round"})}):null};return Object(a.jsxs)("div",{style:{padding:20},children:[Object(a.jsxs)(W.a,{center:[51.505,-.09],zoom:2,style:{height:400,width:"70%",margin:"auto",marginBottom:15},bounds:A.a.latLngBounds(A.a.latLng(90,180),A.a.latLng(-90,-180)),children:[Object(a.jsx)(R,{}),Object(a.jsx)(z.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager_labels_under/{z}/{x}/{y}.png"})]}),d&&Object(a.jsx)(r.a.Fragment,{children:-1!==l?Object(a.jsxs)(T.a,{style:{textAlign:"center",paddingBottom:20},children:["You were ",l.toLocaleString()," KM from the correct position."]}):Object(a.jsx)(T.a,{style:{textAlign:"center",paddingBottom:20},children:"You did not guess this round."})}),s&&!d&&Object(a.jsx)("div",{style:{textAlign:"center"},children:Object(a.jsx)(h.a,{onClick:function(){o(),u(!0);var e=function(e){var t=0;for(e<180?t=360:e>180&&(t=-360);Math.abs(e)>180;)e+=t;return e}(+v.lng);t.emit("handleSendGuess",{position:{lat:v.lat,lng:e}})},variant:"contained",className:N.greenButton,children:"Send"})}),b&&!d&&Object(a.jsx)("div",{style:{textAlign:"center",paddingBottom:20},children:Object(a.jsx)(T.a,{children:"Waiting for other players to finish."})}),Object(a.jsx)(I,{})]})},J=n(94),Y=(n(149),function(e){var t=e.imageUrls,n=e.currentIndex,s=e.setCurrentIndex,o=e.guessSent,i=(e.imageData,Object(c.useState)(void 0)),l=Object(j.a)(i,2),d=l[0],u=l[1],b=r.a.createRef(),O=function(e){d&&d.setPanorama(t[e]).then((function(){}),(function(e){console.log("error",e)}))};Object(c.useEffect)((function(){if(t.length>0)if(d)O(0);else{var e=new J.Viewer({container:b.current,panorama:t[0],navbar:!1});u(e)}}),[null===t||void 0===t?void 0:t.length]);var m=t.length>0?"block":"none";return Object(a.jsxs)(r.a.Fragment,{children:[Object(a.jsxs)("div",{className:"pano-container",style:{display:m},children:[Object(a.jsxs)(T.a,{style:{textAlign:"center"},children:[n+1," / ",t.length," "]}),Object(a.jsx)("button",{className:"pano-btn",id:"pano-prev-btn",onClick:function(){var e=-1;0===n?(s(t.length-1),e=t.length-1):(s(n-1),e=n-1),O(e)},children:Object(a.jsx)("i",{className:"arrow arrow-left"})}),Object(a.jsx)("button",{className:"pano-btn arrow-right",id:"pano-next-btn",onClick:function(){var e=-1;n===t.length-1?(e=0,s(0)):(e=n+1,s(n+1)),O(e)},children:Object(a.jsx)("i",{className:"arrow"})}),Object(a.jsx)("div",{style:{height:400,width:"100%"},id:"viewer",ref:b})]}),Object(a.jsx)("div",{style:{display:t.length>0?"none":"block"},children:o?Object(a.jsx)(T.a,{style:{textAlign:"center"},children:"Waiting for leader to start round."}):Object(a.jsx)("div",{style:{textAlign:"center"},children:Object(a.jsx)(P.a,{})})})]})}),_=n(99),H=n(189),K=n(197),V=n(198),q=n(199),Q=n(200),X=function(e){var t=e.players,n=e.roomName,c=y();return Object(a.jsxs)(_.a,{className:c.cardContainer,children:[Object(a.jsxs)(T.a,{variant:"h6",children:["Players in room ",n]}),Object(a.jsxs)(H.a,{dense:!1,style:{width:400,margin:"auto"},children:[Object(a.jsxs)(K.a,{children:[Object(a.jsx)(V.a,{inset:!0,children:"Name"}),Object(a.jsx)(V.a,{children:"Score"})]}),t.map((function(e,t){var n=t%2===0?"#ffeeee":"inherit";return Object(a.jsx)(r.a.Fragment,{children:Object(a.jsxs)(K.a,{style:{backgroundColor:n},children:[e.isLeader&&Object(a.jsx)(q.a,{children:Object(a.jsx)(Q.a,{})}),Object(a.jsx)(V.a,{inset:!e.isLeader,primary:e.name}),Object(a.jsx)(V.a,{primary:(+e.score).toLocaleString()})]})},"".concat(e.name,"-").concat(t))}))]})]})},Z=function(e){var t=e.socket,n=Object(c.useState)(0),s=Object(j.a)(n,2),o=s[0],i=s[1],l=Object(c.useState)(""),d=Object(j.a)(l,2),u=d[0],b=d[1],O=Object(c.useState)([]),m=Object(j.a)(O,2),g=m[0],x=m[1],f=Object(c.useState)(!1),p=Object(j.a)(f,2),v=p[0],k=p[1],C=Object(c.useState)(!1),w=Object(j.a)(C,2),D=w[0],A=w[1],G=Object(c.useState)([]),L=Object(j.a)(G,2),F=L[0],B=L[1],U=Object(c.useState)(!1),E=Object(j.a)(U,2),W=E[0],z=E[1],J=Object(c.useState)(-1),_=Object(j.a)(J,2),H=_[0],K=_[1],V=Object(c.useState)(void 0),q=Object(j.a)(V,2),Q=q[0],Z=q[1],$=Object(c.useState)(60),ee=Object(j.a)($,2),te=ee[0],ne=ee[1],ae=Object(c.useState)("countDownTimer"),ce=Object(j.a)(ae,2),re=ce[0],se=ce[1],oe=Object(c.useState)(60),ie=Object(j.a)(oe,2),le=ie[0],je=ie[1],de=Object(c.useState)(0),ue=Object(j.a)(de,2),be=ue[0],Oe=ue[1],me=Object(c.useState)(0),he=Object(j.a)(me,2),ge=he[0],xe=he[1],fe=Object(c.useState)(!1),pe=Object(j.a)(fe,2),ve=pe[0],ye=pe[1],Se=Object(c.useState)(!1),Ne=Object(j.a)(Se,2),ke=Ne[0],Ce=Ne[1],we=Object(c.useState)(""),Re=Object(j.a)(we,2),Pe=Re[0],Te=Re[1],Ie=Object(c.useState)(""),De=Object(j.a)(Ie,2),Ae=De[0],Ge=De[1],Le=Object(c.useState)(!1),Fe=Object(j.a)(Le,2),Be=Fe[0],Ue=Fe[1],Ee=Object(c.useState)(!1),We=Object(j.a)(Ee,2),ze=We[0],Me=We[1],Je=Object(c.useState)([]),Ye=Object(j.a)(Je,2),_e=Ye[0],He=Ye[1],Ke=y(),Ve=Object(c.useCallback)((function(){se("countDownTimer"===re?"countDownTimer2":"countDownTimer"),ne(le),A(!0)}),[re,le]);Object(c.useEffect)((function(){t&&(!function(e){var t=e.socket,n=e.setGameOver,a=e.setRoomName,c=e.setCurrentRound,r=e.setNumberOfRounds,s=e.setTimePerRound,o=e.setTimerSeconds,i=e.setPlayers,l=e.setCurrentIndex,j=e.setImageUrls,d=e.setImgUrl,u=e.setImageLoaded,b=e.setDistance,O=e.setGuessSent,m=e.startCountDownTimer,h=e.setRoundOver,g=e.setRoundPosition,x=e.setImageData;t.on("handleSendImages",(function(e){n(!1);var t=e.gameData,f=e.players;f=I(f);var p=e.timePerRound,v=e.currentRound,y=e.numberOfRounds,S=e.roomName;a(S),c(v),r(y),s(p),o(p),i(f);var N=[];if(x(t.features),t.features.length>0){for(var k=0;k<t.features.length;k++){var C=t.features[k].properties.key,w="https://images.mapillary.com/".concat(C,"/thumb-2048.jpg");N.push(w)}console.log("gamedata",t),l(0),j(N),d(N[0]),u(!0),g(void 0),b(-1),O(!1),m(),h(!1)}}))}({socket:t,setGameOver:ye,setRoomName:Te,setCurrentRound:Oe,setNumberOfRounds:xe,setTimePerRound:je,setTimerSeconds:ne,setPlayers:B,setCurrentIndex:i,setImageUrls:x,setImgUrl:b,setImageLoaded:k,setDistance:K,setGuessSent:Ce,startCountDownTimer:Ve,setRoundOver:Ue,setRoundPosition:Z,setImageData:He}),function(e){var t=e.socket,n=e.setPlayerName,a=e.setPlayers,c=e.setRoundPosition,r=e.setDistance,s=e.setIsLeader,o=e.setCountdownStarted,i=e.setRoundOver;t.on("handleRoundOver",(function(e){var t=e.isGameLeader,l=e.correctPosition,j=e.distance,d=e.players,u=e.playerName;n(u),a(d),c(l),r(j),s(t),o(!1),i(!0)}))}({socket:t,setPlayerName:Ge,setPlayers:B,setRoundPosition:Z,setDistance:K,setIsLeader:z,setCountdownStarted:A,setRoundOver:Ue}),t.on("handleGameOver",(function(e){var t=e.players;t=I(t),B(t),ye(!0)})),t.on("gameStarted",(function(){ye(!1),K(-1),Me(!1),Ue(!1),Z(void 0)})))}),[t,Ve]);var qe=function(){Me(!0),t.emit("handleStartGame",{timePerRound:le,numberOfRounds:ge})},Qe=function(){return ze?Object(a.jsx)("div",{style:{textAlign:"center"},children:Object(a.jsx)(P.a,{})}):Object(a.jsx)(h.a,{variant:"contained",onClick:qe,className:Ke.buttonGreen,children:"Play again"})};return Object(a.jsxs)(S,{children:[ve?Object(a.jsxs)("div",{style:{textAlign:"center"},children:[Object(a.jsx)("h3",{children:"Game Over"}),W?Object(a.jsx)(Qe,{}):Object(a.jsx)(T.a,{children:"Waiting for leader to start again"})]}):Object(a.jsxs)(r.a.Fragment,{children:[Object(a.jsxs)("div",{id:"info-container",style:{padding:15,textAlign:"center",position:"relevant"},children:[Object(a.jsx)("div",{id:"count-down-container",style:{margin:"auto",position:"absolute",top:90,left:10},children:Object(a.jsx)(R.CountdownCircleTimer,{isPlaying:D,size:70,duration:te,colors:[["#004777",.33],["#F7B801",.33],["#A30000",.33]],children:function(e){return e.remainingTime}},re)}),Object(a.jsx)("img",{className:Ke.icon,src:N,alt:"jjicon"}),Object(a.jsxs)(T.a,{children:["Round ",be," of ",ge]})]}),Object(a.jsx)(Y,{imgUrl:u,imageUrls:g,currentIndex:o,setCurrentIndex:i,setImgUrl:b,guessSent:ke,imageData:_e}),Object(a.jsx)(M,{socket:t,setImageUrls:x,imageLoaded:v,guessSentCallback:function(){k(!1)},isLeader:W,distance:H,roundPosition:Q,setGuessSent:Ce,guessSent:ke,players:F,playerName:Ae,roundOver:Be,setRoundOver:Ue})]}),F.length>0&&Object(a.jsx)(X,{players:F,roomName:Pe})]})},$=n(201),ee=n(203),te=function(e){var t=e.socket,n=Object(u.a)(e,["socket"]),s=Object(c.useState)(""),o=Object(j.a)(s,2),i=o[0],l=o[1],d=Object(c.useState)([]),b=Object(j.a)(d,2),O=b[0],g=b[1],x=Object(c.useState)(!1),f=Object(j.a)(x,2),p=f[0],v=f[1],N=Object(c.useState)(5),k=Object(j.a)(N,2),C=k[0],w=k[1],R=Object(c.useState)(60),P=Object(j.a)(R,2),I=P[0],D=P[1],A=Object(c.useState)(!0),G=Object(j.a)(A,2),L=G[0],F=G[1],B=Object(c.useState)(!1),U=Object(j.a)(B,2),E=U[0],W=(U[1],y());Object(c.useEffect)((function(){t&&(t.emit("connectedToWaitingRoom"),t.once("connectedToWaitingRoomCallback",(function(e){var t=e.roomName,n=e.players,a=e.isLeader;l(t),v(a),g(n)})),t.on("updatePlayers",(function(e){var t=e.players;t&&g(t)})),t.on("gameStarted",(function(){n.history.push(ae)})))}),[t,n.history]);return Object(a.jsx)(S,{children:Object(a.jsxs)(_.a,{elevation:1,className:W.cardContainer,children:[Object(a.jsx)("h3",{children:"Waiting room"}),Object(a.jsxs)("h5",{children:["Room ",i]}),Object(a.jsxs)(T.a,{children:["To play with your friends, tell them to write '",i,"' in the room inputbox and press connect!"]}),Object(a.jsx)(T.a,{children:"Players in room"}),Object(a.jsx)(H.a,{style:{width:200,margin:"auto"},children:O.map((function(e,t){return Object(a.jsx)(r.a.Fragment,{children:Object(a.jsxs)(K.a,{children:[Object(a.jsx)(V.a,{children:e.name}),e.isLeader?Object(a.jsx)(q.a,{children:Object(a.jsx)(Q.a,{})}):Object(a.jsx)(V.a,{})]})},"".concat(e.name,"-").concat(t))}))}),p?Object(a.jsxs)(r.a.Fragment,{children:[Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(T.a,{children:"Number of Rounds"}),Object(a.jsx)(m.a,{id:"numberofrounds-text-field",type:"number",placeholder:"Number of rounds",value:C,onChange:function(e){return w(e.target.value)}}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(T.a,{children:"Seconds per round"}),Object(a.jsx)(m.a,{id:"timeperround-text-field",type:"number",placeholder:"seconds per round",value:I,onChange:function(e){return D(e.target.value)}}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)($.a,{control:Object(a.jsx)(ee.a,{checked:L,onChange:function(){F(!L)}}),label:"Use only panoramas?"}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(h.a,{onClick:function(){isNaN(+I)||isNaN(+C)||t.emit("handleStartGame",{timePerRound:I,numberOfRounds:C,onlyPano:L,onlyEuropeUsa:E})},variant:"contained",className:W.buttonGreen,children:"Start Game"})]}):Object(a.jsx)(T.a,{children:"Waiting for leader to start the game."})]})})},ne={ENDPOINT:window.location.hostname}.ENDPOINT,ae="/game",ce="/waitingroom",re=function(){var e=Object(c.useState)(void 0),t=Object(j.a)(e,2),n=t[0],r=t[1];return Object(c.useEffect)((function(){var e=w.a.connect(ne);r(e),e.on("connectedToRoomCallBack",(function(e){}))}),[]),Object(a.jsxs)(d.c,{children:[Object(a.jsx)(d.a,{exact:!0,path:"/",render:function(e){return Object(a.jsx)(k,Object(l.a)(Object(l.a)({},e),{},{socket:n}))}}),Object(a.jsx)(d.a,{path:ae,render:function(e){return Object(a.jsx)(Z,Object(l.a)(Object(l.a)({},e),{},{socket:n}))}}),Object(a.jsx)(d.a,{path:ce,render:function(e){return Object(a.jsx)(te,Object(l.a)(Object(l.a)({},e),{},{socket:n}))}})]})};n(151);var se=function(){return Object(a.jsx)(i.a,{basename:"/jeojuessr",children:Object(a.jsx)(re,{})})},oe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,207)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),r(e),s(e)}))};o.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(se,{})}),document.getElementById("root")),oe()},85:function(e,t,n){}},[[152,1,2]]]);
//# sourceMappingURL=main.7939d49e.chunk.js.map